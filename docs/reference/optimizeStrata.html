<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Best stratification of a sampling frame for multipurpose surveys — optimizeStrata • SamplingStrata</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Best stratification of a sampling frame for multipurpose surveys — optimizeStrata" />
<meta property="og:description" content="This function runs a set of other functions to optimise the stratification of a sampling frame" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156503236-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156503236-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SamplingStrata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SamplingStrata.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/models.html">Use of models in SamplingStrata</a>
    </li>
    <li>
      <a href="../articles/spatial.html">Spatial sampling with SamplingStrata</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/barcaroli/SamplingStrata/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Best stratification of a sampling frame for multipurpose surveys</h1>
    
    <div class="hidden name"><code>optimizeStrata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function runs a set of other functions to optimise the stratification of a sampling frame</p>
    </div>

    <pre class="usage"><span class='fu'>optimizeStrata</span>(
        <span class='no'>errors</span> ,
        <span class='no'>strata</span> ,
        <span class='kw'>cens</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
        <span class='kw'>strcens</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
        <span class='kw'>alldomains</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
        <span class='kw'>dom</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
        <span class='kw'>initialStrata</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
        <span class='kw'>addStrataFactor</span> <span class='kw'>=</span> <span class='fl'>0.0</span>,
        <span class='kw'>minnumstr</span> <span class='kw'>=</span> <span class='fl'>2</span>,
        <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>50</span>,
        <span class='kw'>pops</span> <span class='kw'>=</span> <span class='fl'>20</span>,
        <span class='kw'>mut_chance</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
        <span class='kw'>elitism_rate</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
        <span class='kw'>highvalue</span> <span class='kw'>=</span> <span class='fl'>1e+08</span>,
        <span class='kw'>suggestions</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
        <span class='kw'>realAllocation</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
        <span class='kw'>writeFiles</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
        <span class='kw'>showPlot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
        <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
        <span class='no'>cores</span>
        )</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>errors</th>
      <td><p>This is the (mandatory) dataframe containing the precision levels expressed in terms of maximum expected value of the Coefficients of Variation
  related to target variables of the survey.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>This is the (mandatory) dataframe containing the information related to "atomic" strata, i.e. the strata obtained by 
  the Cartesian product of all auxiliary variables X's. Information concerns the identifiability of strata
  (values of X's) and variability of Y's (for each Y, mean and standard error in strata).</p></td>
    </tr>
    <tr>
      <th>cens</th>
      <td><p>This the (optional) dataframe containing the takeall strata, those strata whose units must be selected in whatever sample. It has same structure than "strata" dataframe.</p></td>
    </tr>
    <tr>
      <th>strcens</th>
      <td><p>Flag (TRUE/FALSE) to indicate if takeall strata do exist or not. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>alldomains</th>
      <td><p>Flag (TRUE/FALSE) to indicate if the optimization must be carried out on all domains (default is TRUE). If it is set to FALSE,
  then a value must be given to parameter 'dom'.</p></td>
    </tr>
    <tr>
      <th>dom</th>
      <td><p>Indicates the domain on which the optimization must be carried. It is an integer value that has to be internal to the interval 
  (1 &lt;--&gt; number of domains). If 'alldomains' is set to TRUE, it is ignored.</p></td>
    </tr>
    <tr>
      <th>initialStrata</th>
      <td><p>This is the initial limit on the number of strata in the different domains for each solution. Default is NA, and in this case it is set equal to the
  number of atomic strata in each domain.</p></td>
    </tr>
    <tr>
      <th>addStrataFactor</th>
      <td><p>This parameter indicates the probability that at each mutation the number of strata may increase with 
  respect to the current value. Default is 0.0.</p></td>
    </tr>
    <tr>
      <th>minnumstr</th>
      <td><p>Indicates the minimum number of units that must be allocated in each stratum. Default is 2.</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Indicated the maximum number of iterations (= generations) of the genetic algorithm. Default is 50.</p></td>
    </tr>
    <tr>
      <th>pops</th>
      <td><p>The dimension of each generations in terms of individuals. Default is 20.</p></td>
    </tr>
    <tr>
      <th>mut_chance</th>
      <td><p>Mutation chance: for each new individual, the probability to change each single chromosome, i.e. one bit
  of the solution vector. High values of this parameter allow a deeper exploration of the solution space,
  but a slower convergence, while low values permit a faster convergence, but the final solution can be
  distant from the optimal one. Default is NA, in correspondence of which it is computed as 1/(vars+1) 
  where vars is the length of elements in the solution.</p></td>
    </tr>
    <tr>
      <th>elitism_rate</th>
      <td><p>This  parameter indicates the rate of better solutions that must be preserved from one generation
	to another. Default is 0.2 (20<!-- %). --></p></td>
    </tr>
    <tr>
      <th>highvalue</th>
      <td><p>Parameter for genetic algorithm. In should not be changed</p></td>
    </tr>
    <tr>
      <th>suggestions</th>
      <td><p>Optional parameter for genetic algorithm that indicates a suggested solution to be introduced in the initial population. The most convenient is the one found by the function "KmeanSolution". Default is NULL.</p></td>
    </tr>
    <tr>
      <th>realAllocation</th>
      <td><p>If FALSE, the allocation is based on INTEGER values; if TRUE, the allocation is based on REAL values.
  Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>writeFiles</th>
      <td><p>Indicates if the various dataframes and plots produced during the execution have to be written in the working
  directory.
  Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>showPlot</th>
      <td><p>Indicates if the plot showing the trend in the value of the objective function has to be shown or not. In parallel = TRUE, this defaults to FALSE
  Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Should the analysis be run in parallel.
  Default is TRUE.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>If the analysis is run in parallel, how many cores should be used.
  If not specified n-1 of total available cores are used OR if number of domains &lt; (n-1) cores, then number of cores equal to number of domains are used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing (1) the vector of the solution and (2) the optimal aggregated strata</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>SamplingStrata</span>)
<span class='co'>############################</span>
<span class='co'># Example of "atomic" method</span>
<span class='co'>############################</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>swissmunicipalities</span>)
<span class='no'>swissmunicipalities</span>$<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>swissmunicipalities</span>))
<span class='no'>frame</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='buildFrameDF.html'>buildFrameDF</a></span>(<span class='kw'>df</span> <span class='kw'>=</span> <span class='no'>swissmunicipalities</span>,
                      <span class='kw'>id</span> <span class='kw'>=</span> <span class='st'>"id"</span>,
                      <span class='kw'>domainvalue</span> <span class='kw'>=</span> <span class='st'>"REG"</span>,
                      <span class='kw'>X</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"POPTOT"</span>,<span class='st'>"HApoly"</span>),
                      <span class='kw'>Y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Surfacesbois"</span>, <span class='st'>"Airind"</span>))
<span class='no'>ndom</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>frame</span>$<span class='no'>domainvalue</span>))
<span class='no'>cv</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>DOM</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"DOM1"</span>,<span class='no'>ndom</span>),
                         <span class='kw'>CV1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.1</span>,<span class='no'>ndom</span>),
                         <span class='kw'>CV2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.1</span>,<span class='no'>ndom</span>),
                         <span class='kw'>domainvalue</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>:<span class='no'>ndom</span>)))
<span class='no'>strata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='buildStrataDF.html'>buildStrataDF</a></span>(<span class='no'>frame</span>)
<span class='no'>kmean</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='KmeansSolution.html'>KmeansSolution</a></span>(<span class='no'>strata</span>,<span class='no'>cv</span>,<span class='kw'>maxclusters</span><span class='kw'>=</span><span class='fl'>30</span>)
<span class='no'>nstrat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tapply.html'>tapply</a></span>(<span class='no'>kmean</span>$<span class='no'>suggestions</span>, <span class='no'>kmean</span>$<span class='no'>domainvalue</span>,
                 <span class='kw'>FUN</span><span class='kw'>=</span><span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span>(<span class='no'>x</span>)))
<span class='no'>solution</span> <span class='kw'>&lt;-</span> <span class='fu'>optimizeStrata</span>(<span class='kw'>strata</span> <span class='kw'>=</span> <span class='no'>strata</span>,
                        <span class='kw'>errors</span> <span class='kw'>=</span> <span class='no'>cv</span>,
                        <span class='kw'>initialStrata</span> <span class='kw'>=</span> <span class='no'>nstrat</span>,
                        <span class='kw'>suggestions</span> <span class='kw'>=</span> <span class='no'>kmean</span>,
                        <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>50</span>,
                        <span class='kw'>pops</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>outstrata</span> <span class='kw'>&lt;-</span> <span class='no'>solution</span>$<span class='no'>aggr_strata</span>
<span class='no'>newstrata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='updateStrata.html'>updateStrata</a></span>(<span class='no'>strata</span>,<span class='no'>solution</span>)
<span class='no'>framenew</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='updateFrame.html'>updateFrame</a></span>(<span class='no'>frame</span>, <span class='no'>newstrata</span>)
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='selectSample.html'>selectSample</a></span>(<span class='no'>framenew</span>, <span class='no'>outstrata</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Giulio Barcaroli, Marco Ballin, Hanjo Odendaal, Daniela Pagliuca, Egon Willighagen, Diego Zardetto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


