<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Execution and compared evaluation of optimization runs — tuneParameters • SamplingStrata</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Execution and compared evaluation of optimization runs — tuneParameters"><meta property="og:description" content="This function allows to execute a number of optimization runs,
varying in a controlled way the values of the parameters, in order to find their most suitable values.
by comparing the resulting solutions.
It can be applied only to a given domain per time.
Most parameters of this function are the same than those of the function 'optimizeStrata', but they are given 
in a vectorial format. The length of each vector is given by the number of optimizations to be run: 
it is therefore possible to define different combination of values of the parameters for each execution of 'optimizeStrata'.
After each optimization run, from the corrisponding optimized frame a given number of samples are drawn. For each of them, the 
estimates of the target variables Y's are computed (&quot;precision&quot;), together with the associated coefficients of variations, 
and the absolute differences between the values of the estimates and the true values in the population (&quot;bias&quot;).
Information on the distribution of bias (differences) and precision (CV's) are outputted, and also boxplots 
for each of them are produced, in order to permit a compared evaluation of the different solutions found in the different runs.
As the optimal solution is stored for each run, after the evaluation it is possible to use it directly, or as a
&quot;suggestion&quot; for a new optimization with more iterations (in order to improve it)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-156503236-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156503236-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SamplingStrata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/SamplingStrata.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/drake_continuous.html">SamplingStrata workflow with drake</a>
    </li>
    <li>
      <a href="../articles/models.html">Use of models in SamplingStrata</a>
    </li>
    <li>
      <a href="../articles/spatial.html">Spatial sampling with SamplingStrata</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/barcaroli/SamplingStrata/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Execution and compared evaluation of optimization runs</h1>
    
    <div class="hidden name"><code>tuneParameters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to execute a number of optimization runs,
varying in a controlled way the values of the parameters, in order to find their most suitable values.
by comparing the resulting solutions.
It can be applied only to a given domain per time.
Most parameters of this function are the same than those of the function 'optimizeStrata', but they are given 
in a vectorial format. The length of each vector is given by the number of optimizations to be run: 
it is therefore possible to define different combination of values of the parameters for each execution of 'optimizeStrata'.
After each optimization run, from the corrisponding optimized frame a given number of samples are drawn. For each of them, the 
estimates of the target variables Y's are computed ("precision"), together with the associated coefficients of variations, 
and the absolute differences between the values of the estimates and the true values in the population ("bias").
Information on the distribution of bias (differences) and precision (CV's) are outputted, and also boxplots 
for each of them are produced, in order to permit a compared evaluation of the different solutions found in the different runs.
As the optimal solution is stored for each run, after the evaluation it is possible to use it directly, or as a
"suggestion" for a new optimization with more iterations (in order to improve it).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tuneParameters</span> <span class="op">(</span></span>
<span>    <span class="va">noptim</span>,</span>
<span>    <span class="va">nsampl</span>,</span>
<span>    <span class="va">frame</span>,</span>
<span>    errors <span class="op">=</span> <span class="va">errors</span>, </span>
<span>    strata <span class="op">=</span> <span class="va">strata</span>, </span>
<span>    cens <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    strcens <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    alldomains <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dom <span class="op">=</span> <span class="fl">1</span>,      </span>
<span>    <span class="va">initialStrata</span>, </span>
<span>    <span class="va">addStrataFactor</span>, </span>
<span>    <span class="va">minnumstr</span>, </span>
<span>    <span class="va">iter</span>, </span>
<span>    <span class="va">pops</span>, </span>
<span>    <span class="va">mut_chance</span>, </span>
<span>    <span class="va">elitism_rate</span>,</span>
<span>    <span class="va">writeFiles</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>noptim</dt>
<dd><p>Number of optimization runs to be performed</p></dd>

  <dt>nsampl</dt>
<dd><p>Number of samples to be drawn from the optimized population frame after each optimization</p></dd>

  <dt>frame</dt>
<dd><p>The (mandatory) dataframe containing the sampling frame</p></dd>

  <dt>errors</dt>
<dd><p>This is the (mandatory) dataframe containing the precision levels expressed in terms of Coefficients of Variation
  that estimates on target variables Y's of the survey must comply</p></dd>

  <dt>strata</dt>
<dd><p>This is the (mandatory) dataframe containing the information related to "atomic" strata, i.e. the strata obtained by 
  the Cartesian product of all auxiliary variables X's. Information concerns the identifiability of strata
  (values of X's) and variability of Y's (for each Y, mean and standard error in strata)</p></dd>

  <dt>cens</dt>
<dd><p>This the (optional) dataframe containing the takeall strata, those strata whose units must be selected in 
  whatever sample. It has same structure than "strata" dataframe</p></dd>

  <dt>strcens</dt>
<dd><p>Flag (TRUE/FALSE) to indicate if takeall strata do exist or not. Default is FALSE</p></dd>

  <dt>alldomains</dt>
<dd><p>Flag (TRUE/FALSE) to indicate if the optimization must be carried out on all domains. It must be left to its default (FALSE)</p></dd>

  <dt>dom</dt>
<dd><p>Indicates the domain on which the optimization runs must be performed. It is an integer value that has to be internal to the interval 
  (1 &lt;--&gt; number of domains). It is mandatory, if not indicated, the default (1) is taken.</p></dd>

  <dt>initialStrata</dt>
<dd><p>This is the initial limit on the number of strata for each solution. Default is 3000.
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>addStrataFactor</dt>
<dd><p>This parameter indicates the probability that at each mutation the number of strata may increase with 
  respect to the current value. Default is 0.01 (1<!-- %). -->
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>minnumstr</dt>
<dd><p>Indicates the minimum number of units that must be allocated in each stratum. Default is 2.
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>iter</dt>
<dd><p>Indicated the maximum number of iterations (= generations) of the genetic algorithm. Default is 20.
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>pops</dt>
<dd><p>The dimension of each generations in terms of individuals. Default is 50.
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>mut_chance</dt>
<dd><p>Mutation chance: for each new individual, the probability to change each single chromosome, i.e. one bit
  of the solution vector. High values of this parameter allow a deeper exploration of the solution space,
  but a slower convergence, while low values permit a faster convergence, but the final solution can be
  distant from the optimal one. Default is 0.05.
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>elitism_rate</dt>
<dd><p>This  parameter indicates the rate of better solutions that must be preserved from one generation
  to another. Default is 0.2 (20<!-- %). -->
  This parameter has to be given in a vectorial format, whose length is given by the number of different optimisations
  ( = value of parameter 'noptim')</p></dd>

  <dt>writeFiles</dt>
<dd><p>Indicates if the various dataframes and plots produced during the execution have to be written in the working
  directory.
  Default is FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A dataframe containing for each iteration the number of strata, the cost of the solution and the values of the expected CV's</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Giulio Barcaroli</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># data setting</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://barcaroli.github.io/SamplingStrata/" class="external-link">SamplingStrata</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">swissstrata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">swisserrors</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">swissframe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># As this function can be applied only to a given domain per time,</span></span></span>
<span class="r-in"><span><span class="co"># we select the first domain</span></span></span>
<span class="r-in"><span><span class="va">frame</span> <span class="op">&lt;-</span> <span class="va">swissframe</span><span class="op">[</span><span class="va">swissframe</span><span class="op">$</span><span class="va">domainvalue</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="va">swissstrata</span><span class="op">[</span><span class="va">swissstrata</span><span class="op">$</span><span class="va">DOM1</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">swisserrors</span><span class="op">[</span><span class="va">swisserrors</span><span class="op">$</span><span class="va">domainvalue</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># parameters setting</span></span></span>
<span class="r-in"><span><span class="va">noptim</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># Number of runs</span></span></span>
<span class="r-in"><span><span class="va">nsampl</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># Number of samples to be drawn after each optimization</span></span></span>
<span class="r-in"><span><span class="va">initialStrata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">noptim</span><span class="op">)</span><span class="op">*</span><span class="fl">0.1</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">strata</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Number of initial strata</span></span></span>
<span class="r-in"><span><span class="va">addStrataFactor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="va">noptim</span><span class="op">)</span> <span class="co"># Rate for increasing initial strata</span></span></span>
<span class="r-in"><span><span class="va">minnumstr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="va">noptim</span><span class="op">)</span> <span class="co"># Minimum number of units per stratum</span></span></span>
<span class="r-in"><span><span class="va">iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">200</span>,<span class="va">noptim</span><span class="op">)</span> <span class="co"># Number of iterations for each optimization</span></span></span>
<span class="r-in"><span><span class="va">pops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>,<span class="va">noptim</span><span class="op">)</span> <span class="co"># Number of solutions for each iteration</span></span></span>
<span class="r-in"><span><span class="va">mut_chance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.004</span>,<span class="va">noptim</span><span class="op">)</span> <span class="co"># Mutation chance</span></span></span>
<span class="r-in"><span><span class="va">elitism_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="va">noptim</span><span class="op">)</span> <span class="co"># Elitism rate</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">tuneParameters</span> <span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">noptim</span>,</span></span>
<span class="r-in"><span>  <span class="va">nsampl</span>,</span></span>
<span class="r-in"><span>  <span class="va">frame</span>,</span></span>
<span class="r-in"><span>  errors <span class="op">=</span> <span class="va">errors</span>, </span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="va">strata</span>,</span></span>
<span class="r-in"><span>  cens <span class="op">=</span> <span class="cn">NULL</span>, </span></span>
<span class="r-in"><span>  strcens <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  alldomains <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  dom <span class="op">=</span> <span class="fl">1</span>,      </span></span>
<span class="r-in"><span>  <span class="va">initialStrata</span>, </span></span>
<span class="r-in"><span>  <span class="va">addStrataFactor</span>, </span></span>
<span class="r-in"><span>  <span class="va">minnumstr</span>, </span></span>
<span class="r-in"><span>  <span class="va">iter</span>, </span></span>
<span class="r-in"><span>  <span class="va">pops</span>, </span></span>
<span class="r-in"><span>  <span class="va">mut_chance</span>, </span></span>
<span class="r-in"><span>  <span class="va">elitism_rate</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Giulio Barcaroli, Marco Ballin, Hanjo Odendaal, Daniela Pagliuca, Egon Willighagen, Diego Zardetto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

